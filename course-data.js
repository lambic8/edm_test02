// EDM学習コース - 基本データ定義（Avicii風対応版・18ステップ対応・音響最適化版）
window.EDMCourseData = {
    name: "EDM制作コース - Avicii風感動的楽曲制作（音響最適化版）",
    description: "美しいピアノから壮大なドロップまでのAvicii風音楽的旅路を18ステップで体験（音響負荷軽減対応）",
    totalSteps: 18,
    
    sections: {
        intro: { name: "Intro", bars: 8 },
        preBuildup: { name: "PreBuild", bars: 1 },
        buildup: { name: "Buildup", bars: 8 },
        preDrop: { name: "PreDrop", bars: 1 },
        drop: { name: "Drop", bars: 16 },
        preBreakdown: { name: "PreBreak", bars: 1 },
        breakdown: { name: "Break", bars: 8 },
        outro: { name: "Outro", bars: 8 }
    },
    
    instruments: {
        drums: {
            kick: { name: "Kick", icon: "🥁", color: "#ff6b6b" },
            snare: { name: "Snare", icon: "🥁", color: "#4ecdc4" },
            hihat: { name: "HiHat", icon: "🎩", color: "#45b7d1" },
            clap: { name: "Clap", icon: "👏", color: "#f9ca24" }
        },
        bass: { name: "Bass", icon: "🎸", color: "#6c5ce7" },
        melody: { name: "Lead", icon: "⚡", color: "#a29bfe" },
        chord: { name: "Chord", icon: "🎹", color: "#fd79a8" },
        piano: { name: "Piano", icon: "🎹", color: "#8b4513" },
        pluck: { name: "Pluck", icon: "✨", color: "#daa520" },
        strings: { name: "Strings", icon: "🎻", color: "#00cec9" },
        transitions: {
            riser: { name: "Rise", icon: "📈", color: "#e17055" },
            sweep: { name: "Sweep", icon: "🌊", color: "#00b894" }
        }
    },
    
    inheritanceRules: {
        'intro-preBuildup': {
            inherit: ['piano', 'strings', 'kick', 'bass'],
            explanation: 'プレビルドアップでは美しいピアノアルペジオ、ストリングスハーモニー、キック、ベースラインをすべて継承し、プラックシンセを追加してAvicii風の躍動感を構築します。'
        },
        'preBuildup-buildup': {
            inherit: ['piano', 'strings', 'kick', 'bass', 'pluck'],
            explanation: 'ビルドアップではプレビルドアップの全要素（ピアノ、ストリングス、キック、ベース、プラック）を継承し、スネア・ハイハット・メロディ・クラップを段階的に追加してエネルギーを蓄積します。'
        },
        'buildup-preDrop': {
            inherit: ['kick', 'snare', 'hihat', 'clap', 'bass', 'pluck'],
            explanation: 'プレドロップでは最大テンション構築のため、リズム系楽器（キック、スネア、ハイハット、クラップ）、ベース、プラックを継承し、最小限のライザーを追加します。ピアノ・ストリングス・メロディは一時的に除去され、次のドロップでの爆発的効果を演出します。'
        },
        'preDrop-drop': {
            inherit: ['kick', 'snare', 'hihat', 'clap', 'bass', 'pluck'],
            explanation: 'ドロップではプレドロップのリズム基盤を継承し、新たに感動的なピアノメロディとシンプルなコードハーモニーを追加してAvicii風の壮大なクライマックスを実現します。'
        },
        'drop-preBreakdown': {
            inherit: ['piano', 'melody', 'strings', 'sweep'],
            explanation: 'プレブレイクダウンでは感動的移行のため、美しいピアノ、メロディ、ストリングスのみを継承し、スイープエフェクトを追加します。すべてのドラム系楽器（キック、スネア、ハイハット、クラップ）とベース、プラック、コードは除去され、静寂への移行が始まります。'
        },
        'preBreakdown-breakdown': {
            inherit: ['piano', 'strings'],
            explanation: 'ブレイクダウンでは最も美しい要素のみを継承し、ピアノとストリングスによる感動的なハーモニーを表現します。メロディ、スイープは除去され、純粋な美しさが際立ちます。'
        },
        'breakdown-outro': {
            inherit: ['piano'],
            explanation: 'アウトロでは楽曲の終結として、最も核心的なピアノのみを継承します。ストリングスは除去され、シンプルで美しい終結を実現します。'
        }
    },
    
    scales: {
        bass: ["C1", "D1", "E1", "F1", "G1", "A1", "B1", "C2", "D2", "E2", "F2", "G2"],
        melody: ["C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5", "D5", "E5", "F5", "G5"],
        chord: ["C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5", "D5", "E5", "F5", "G5"],
        piano: ["C3", "D3", "E3", "F3", "G3", "A3", "B3", "C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5", "D5", "E5", "F5", "G5"],
        pluck: ["C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5", "D5", "E5", "F5", "G5"],
        strings: ["C3", "D3", "E3", "F3", "G3", "A3", "B3", "C4", "D4", "E4", "F4", "G4"]
    },
    
    learningTips: {
        1: "🎹 Aviciiスタイルの美学：美しいピアノアルペジオから始まる楽曲は、EDMとクラシックの融合を体現します。このC-E-G-C5-E5の上行アルペジオは「Levels」や「Waiting for Love」で使用される基本パターンで、聴き手の心を即座に捉える魔法の響きです。16分音符を活用することで、1小節内でも十分な音楽的情報を伝えることができます。",
        
        2: "🎻 ハーモニーの土台構築：ストリングスの長いトーンがピアノアルペジオに深みと広がりを与えます。AviciiはピアノとストリングスorchestrationによるEmotional Buildupを得意とし、「Wake Me Up」「Hey Brother」でもこの手法を多用しています。C3とG3のハーモニーがピアノメロディの土台となり、楽曲全体に安定感と感情的な深度を提供します。",
        
        3: "🥁 グルーヴの始まり：4つ打ちキックの導入により、楽曲はアコースティックからエレクトロニックへの変化を開始します。Aviciiの「Wake Me Up」でもフォーク調のイントロからEDMへの劇的な変化が印象的です。ここでのキックは控えめでありながら、確実にダンスフロアへの入り口を提示する重要な役割を果たします。",
        
        4: "🎸 ベースラインの魔法：C2-F2-G2-C2のベースパターンは、I-IV-V-Iの基本的な循環コード進行を表現しています。これはAviciiが「Levels」で使用したAm-F-C-G進行の低音域版で、西洋音楽の最も自然で心地よい和声進行です。このベースラインが楽曲に推進力と安定感を与え、上に乗るメロディを美しく支えます。",
        
        5: "✨ Avicii特有のプラックサウンド：「Levels」で印象的だったプラックシンセをオフビートで配置します。G4の16分音符リズムパターンは、楽曲にシンコペーションと躍動感を与え、静的だったピアノアルペジオに動的な要素を加えます。これによりAvicii特有の「踊れるメロディ」が完成し、聴く人の体が自然にリズムを刻み始めます。",
        
        6: "🎯 リズムセクションの完成：スネアの2・4拍配置とハイハットのオフビートにより、楽曲は完全なEDMグルーヴを獲得します。Aviciiの楽曲では、アコースティック要素とエレクトロニック要素が自然に融合し、どちらも生きたサウンドを作り出します。この段階で、聴き手は「美しいピアノ曲」から「踊れるEDM」への変化を明確に感じることができます。",
        
        7: "⚡ メロディックリードの導入：Avicii風の感動的なメロディラインが登場します。E4-D4-E4-F4-G4という上昇フレーズは「Levels」のメインリフを彷彿とさせ、続くF4-E4-D4-C4の下降で完璧な音楽的バランスを作ります。この16分音符を活用したメロディは、1小節の制約内でも十分に印象的で記憶に残るフックを生み出します。",
        
        8: "👏 エネルギーの完成：クラップの追加により楽曲は最高のエネルギー状態に到達します。この段階ですべての要素が調和し、Avicii特有の「美しくて踊れる」サウンドが完成します。ピアノ、ストリングス、プラック、そしてパーカッションが織りなすサウンドスケープは、まさにAviciiが「Levels」や「Wake Me Up」で実現した音楽の魔法そのものです。",
        
        9: "🎵 ビルドアップ完成形：音響負荷を考慮し、エフェクト系楽器を使わずに完璧なビルドアップを実現しました。Aviciiの楽曲制作では、「Less is More」の哲学が重要で、必要最小限の要素で最大の効果を生み出します。この段階ですべての楽器が調和し、次のドロップへの完璧な準備が整っています。",
        
        10: "📈 最適化されたテンション構築：音響安定性を重視し、ライザーを最小限（16拍目のみ）に抑えながらも、ドロップへの期待感を演出します。Aviciiは常に技術的制約を創造的に解決し、シンプルな手法で強烈な効果を生み出すマスターでした。この最適化されたアプローチにより、安定した音響環境で学習を継続できます。",
        
        11: "💥 感動的ドロップの爆発：美しいピアノから始まった楽曲が、ついにAvicii風の感動的なドロップに到達しました！C4-E4-G4-C5-E5のアルペジオパターンは「Waiting for Love」を彷彿とさせ、16分音符フル活用により1小節内でも十分に印象的なメロディを実現しています。この瞬間、聴き手は美しさと躍動感の完璧な融合を体験します。",
        
        12: "🎼 最適化されたハーモニー：音響負荷軽減のため、コード進行をC4-G4の2音（パワーコード）に最適化しました。この手法は「Levels」でも頻繁に使用され、シンプルながら非常に強力な響きを生み出します。複雑な4音コードと比較して50%の音響負荷軽減を実現しながら、Avicii特有の力強いハーモニーを完全に表現しています。",
        
        13: "🌊 効率的なプラックパターン：音響最適化により、プラックを4拍子の強拍（4, 8, 12, 16拍目）のみに配置しました。この最適化により75%の音響負荷軽減を実現しながら、「Levels」の本質的なグルーヴは完全に維持されています。Aviciiの楽曲制作哲学「効率的な美しさ」を体現した手法です。",
        
        14: "🌅 感情的移行の準備：ストリングスのスイープ効果により、楽曲は次の感情的なセクションへの移行を準備します。Aviciiの楽曲では、エネルギッシュなドロップの後に必ず感情的で美しいブレイクダウンが配置され、聴き手に多層的な音楽体験を提供します。この移行技術こそが、Aviciiを単なるEDMプロデューサーから音楽アーティストへと昇華させた要素です。",
        
        15: "🌙 美しいブレイクダウンの始まり：ドラムレスの環境でピアノとストリングスが織りなす美しいハーモニー。D4-F4-A4-D5のアルペジオは新たな調性を導入し、楽曲に感情的な深みを加えます。「Wake Me Up」のアコースティックセクションのように、EDMの中に純粋な音楽的美しさを見出すAvicii特有の手法です。この静寂の美しさが、前のドロップのエネルギーをより印象的にします。",
        
        16: "🎭 ハーモニーの進化：ピアノメロディとストリングスハーモニーがさらに発展し、楽曲に深い感情的な色彩を加えます。この組み合わせはマイナーコードの暖かさと憂いを表現し、Aviciiが「For a Better Day」や「The Nights」で使用した感情表現技法です。音楽は単なる音の組み合わせを超え、人の心に直接語りかける言語となります。",
        
        17: "🎯 エレガントな終結：楽曲は美しいシンプルさに還元されます。C4-E4-G4のトライアドは、複雑だった楽曲を純粋なエッセンスに戻していきます。Aviciiの楽曲では、どんなに複雑な展開があっても、最終的には美しいメロディという核心に収束します。これは「音楽の本質は美しさにある」というAviciiの哲学の表れです。",
        
        18: "🎊 音響最適化版楽曲完成：美しいピアノアルペジオから始まり、感動的なドロップを経て、静寂な美しさで終わる完璧なAvicii風楽曲が完成しました！音響負荷を大幅に軽減しながらも、「Levels」「Wake Me Up」「Waiting for Love」と同じDNAを持つ感動的な楽曲を実現。技術的制約を創造性で乗り越える、真のAvicii精神を体験しました！"
    },
    
    successMessages: {
        1: "🎹 美しいピアノイントロ完成！ Avicii風の感動的な音楽的旅路がスタートしました。",
        2: "🎻 ストリングスハーモニー追加！ ピアノに深みと感情的な広がりが生まれました。", 
        3: "🥁 リズム導入完了！ アコースティックからエレクトロニックへの変化が始まりました。",
        4: "🎸 ベースライン完成！ I-IV-V-I進行で楽曲に安定感と推進力が生まれました。",
        5: "✨ プラックシンセ追加！ Avicii特有のシンコペーションで躍動感が生まれました。",
        6: "🎯 リズムセクション完成！ EDMグルーヴが確立され、踊れる楽曲になりました。",
        7: "⚡ 感動的メロディ完成！ Avicii風の印象的なメロディラインが誕生しました。",
        8: "👏 エネルギー最大到達！ すべての要素が調和したAviciiサウンドが完成しました。",
        9: "🎵 最適化ビルドアップ完成！ 音響負荷を抑えながら完璧なエネルギーを実現しました。",
        10: "📈 効率的テンション構築完成！ 最小限のエフェクトで最大の期待感を演出しました。",
        11: "💥 感動的ドロップ爆発！ 美しいピアノから始まった楽曲が壮大なクライマックスに到達しました。",
        12: "🎼 最適化ハーモニー完成！ パワーコードにより効率的で力強い響きを実現しました。",
        13: "🌊 効率的Aviciiグルーヴ完成！ 音響負荷を軽減しながら「Levels」の本質を体現しました。",
        14: "🌅 感情的移行準備完了！ 次のセクションへの美しい橋渡しが完成しました。",
        15: "🌙 美しいブレイクダウン完成！ ピアノとストリングスが織りなす感動的なハーモニーが誕生しました。",
        16: "🎭 ハーモニー進化完了！ 感情的な深みと色彩が楽曲に加わりました。",
        17: "🎯 エレガントな終結完成！ シンプルな美しさで楽曲の核心を表現しました。",
        18: "🎊 音響最適化版Avicii風楽曲完成！ 技術と創造性の融合により、理想的な学習環境を実現しました！"
    },
    
    createInitialData() {
        const emptyPattern = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
        const allTracks = ['kick', 'snare', 'hihat', 'clap', 'bass', 'melody', 'chord', 'piano', 'pluck', 'strings', 'riser', 'sweep'];
        const sections = Object.keys(this.sections);
        const preSection = ['preBuildup', 'preDrop', 'preBreakdown'];
        
        const initialData = { sections: {} };
        
        sections.forEach(sectionKey => {
            initialData.sections[sectionKey] = {
                patterns: {},
                matrix: {}
            };
            
            allTracks.forEach(track => {
                initialData.sections[sectionKey].patterns[track] = [...emptyPattern];
                
                if (preSection.includes(sectionKey)) {
                    initialData.sections[sectionKey].matrix[track] = { repeat1: false };
                } else {
                    initialData.sections[sectionKey].matrix[track] = { repeat1: false, repeat2: false };
                }
            });
        });
        
        return initialData;
    }
};