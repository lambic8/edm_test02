// EDM学習コース - 基本データ定義（Avicii風対応版）
window.EDMCourseData = {
    name: "EDM制作コース - Avicii風感動的楽曲制作",
    description: "美しいピアノから壮大なドロップまでのAvicii風音楽的旅路を20ステップで体験",
    totalSteps: 20,
    
    sections: {
        intro: { name: "Intro", bars: 8 },
        preBuildup: { name: "PreBuild", bars: 1 },
        buildup: { name: "Buildup", bars: 8 },
        preDrop: { name: "PreDrop", bars: 1 },
        drop: { name: "Drop", bars: 16 },
        preBreakdown: { name: "PreBreak", bars: 1 },
        breakdown: { name: "Break", bars: 8 },
        preOutro: { name: "PreOut", bars: 1 },
        outro: { name: "Outro", bars: 8 }
    },
    
    instruments: {
        drums: {
            kick: { name: "Kick", icon: "🥁", color: "#ff6b6b" },
            snare: { name: "Snare", icon: "🥁", color: "#4ecdc4" },
            hihat: { name: "HiHat", icon: "🎩", color: "#45b7d1" },
            clap: { name: "Clap", icon: "👏", color: "#f9ca24" }
        },
        bass: { name: "Bass", icon: "🎸", color: "#6c5ce7" },
        melody: { name: "Lead", icon: "⚡", color: "#a29bfe" },
        chord: { name: "Chord", icon: "🎹", color: "#fd79a8" },
        piano: { name: "Piano", icon: "🎹", color: "#8b4513" },
        pluck: { name: "Pluck", icon: "✨", color: "#daa520" },
        strings: { name: "Strings", icon: "🎻", color: "#00cec9" },
        transitions: {
            uplifter: { name: "Lift", icon: "🚀", color: "#ff9f43" },
            riser: { name: "Rise", icon: "📈", color: "#e17055" },
            sweep: { name: "Sweep", icon: "🌊", color: "#00b894" }
        }
    },
    
    inheritanceRules: {
        'intro-preBuildup': {
            inherit: ['piano', 'strings', 'bass'],
            explanation: 'プレビルドアップではピアノの美しさを継承し、リズム要素を追加します。'
        },
        'preBuildup-buildup': {
            inherit: ['piano', 'strings', 'bass', 'kick', 'uplifter'],
            explanation: 'ビルドアップではピアノとストリングスの美しさを維持しながら、エネルギーを蓄積します。'
        },
        'buildup-preDrop': {
            inherit: ['kick', 'snare', 'hihat', 'clap', 'bass', 'pluck'],
            explanation: 'プレドロップでは最大限のテンションを作り、ドロップへの期待感を演出します。'
        },
        'preDrop-drop': {
            inherit: ['kick', 'snare', 'hihat', 'clap', 'bass', 'pluck'],
            explanation: 'ドロップではAvicii風の感動的なメロディとハーモニーが爆発します。'
        },
        'drop-preBreakdown': {
            inherit: ['piano', 'melody', 'strings', 'sweep'],
            explanation: 'プレブレイクダウンでは感動的な要素のみを残し、静寂への移行を準備します。'
        },
        'preBreakdown-breakdown': {
            inherit: ['piano', 'strings'],
            explanation: 'ブレイクダウンでは美しいピアノとストリングスで感情的な表現を行います。'
        },
        'breakdown-preOutro': {
            inherit: ['piano'],
            explanation: 'プレアウトロではピアノソロで終結への準備をします。'
        },
        'preOutro-outro': {
            inherit: ['piano'],
            explanation: 'アウトロでは美しいピアノで楽曲を感動的に終結させます。'
        }
    },
    
    scales: {
        bass: ["C1", "D1", "E1", "F1", "G1", "A1", "B1", "C2", "D2", "E2", "F2", "G2"],
        melody: ["C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5", "D5", "E5", "F5", "G5"],
        chord: ["C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5", "D5", "E5", "F5", "G5"],
        piano: ["C3", "D3", "E3", "F3", "G3", "A3", "B3", "C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5", "D5", "E5"],
        pluck: ["C4", "D4", "E4", "F4", "G4", "A4", "B4", "C5", "D5", "E5", "F5", "G5"],
        strings: ["C3", "D3", "E3", "F3", "G3", "A3", "B3", "C4", "D4", "E4", "F4", "G4"]
    },
    
    learningTips: {
        1: "🎹 Aviciiスタイルの美学：美しいピアノアルペジオから始まる楽曲は、EDMとクラシックの融合を体現します。このC-E-G-C5-E5の上行アルペジオは「Levels」や「Waiting for Love」で使用される基本パターンで、聴き手の心を即座に捉える魔法の響きです。16分音符を活用することで、1小節内でも十分な音楽的情報を伝えることができます。",
        
        2: "🎻 ハーモニーの土台構築：ストリングスの長いトーンがピアノアルペジオに深みと広がりを与えます。AviciiはピアノとストリングスorchestrationによるEmotional Buildupを得意とし、「Wake Me Up」「Hey Brother」でもこの手法を多用しています。C3とG3のハーモニーがピアノメロディの土台となり、楽曲全体に安定感と感情的な深度を提供します。",
        
        3: "🥁 グルーヴの始まり：4つ打ちキックの導入により、楽曲はアコースティックからエレクトロニックへの変化を開始します。Aviciiの「Wake Me Up」でもフォーク調のイントロからEDMへの劇的な変化が印象的です。ここでのキックは控えめでありながら、確実にダンスフロアへの入り口を提示する重要な役割を果たします。",
        
        4: "🎸 ベースラインの魔法：C2-F2-G2-C2のベースパターンは、I-IV-V-Iの基本的な循環コード進行を表現しています。これはAviciiが「Levels」で使用したAm-F-C-G進行の低音域版で、西洋音楽の最も自然で心地よい和声進行です。このベースラインが楽曲に推進力と安定感を与え、上に乗るメロディを美しく支えます。",
        
        5: "✨ Avicii特有のプラックサウンド：「Levels」で印象的だったプラックシンセをオフビートで配置します。G4の16分音符リズムパターンは、楽曲にシンコペーションと躍動感を与え、静的だったピアノアルペジオに動的な要素を加えます。これによりAvicii特有の「踊れるメロディ」が完成し、聴く人の体が自然にリズムを刻み始めます。",
        
        6: "🎯 リズムセクションの完成：スネアの2・4拍配置とハイハットのオフビートにより、楽曲は完全なEDMグルーヴを獲得します。Aviciiの楽曲では、アコースティック要素とエレクトロニック要素が自然に融合し、どちらも生きたサウンドを作り出します。この段階で、聴き手は「美しいピアノ曲」から「踊れるEDM」への変化を明確に感じることができます。",
        
        7: "⚡ メロディックリードの導入：Avicii風の感動的なメロディラインが登場します。E4-D4-E4-F4-G4という上昇フレーズは「Levels」のメインリフを彷彿とさせ、続くF4-E4-D4-C4の下降で完璧な音楽的バランスを作ります。この16分音符を活用したメロディは、1小節の制約内でも十分に印象的で記憶に残るフックを生み出します。",
        
        8: "👏 エネルギーの完成：クラップの追加により楽曲は最高のエネルギー状態に到達します。この段階ですべての要素が調和し、Avicii特有の「美しくて踊れる」サウンドが完成します。ピアノ、ストリングス、プラック、そしてパーカッションが織りなすサウンドスケープは、まさにAviciiが「Levels」や「Wake Me Up」で実現した音楽の魔法そのものです。",
        
        9: "🚀 ビルドアップの開始：アップリフターの追加により、楽曲は新たな展開への準備を開始します。13, 15拍目の配置は、聴き手に「何かが起こる」という期待感を植え付けます。Aviciiのビルドアップは決して急激ではなく、段階的に感情を高めていく巧妙な構成が特徴です。美しいメロディを保ちながらテンションを蓄積していきます。",
        
        10: "📈 テンション構築の技術：ライザーにより楽曲は「嵐の前の静けさ」を演出します。14-16拍目の連続したライザーは、次に来るドロップへの強烈な期待感を構築します。Aviciiは常に聴き手の感情をコントロールし、「今か今か」という期待感を最大限に高めてからクライマックスを迎えるマスターです。この瞬間の緊張感が、続くドロップでの解放感を何倍にも増幅させます。",
        
        11: "💥 感動的ドロップの爆発：美しいピアノから始まった楽曲が、ついにAvicii風の感動的なドロップに到達しました！C4-E4-G4-C5-E5のアルペジオパターンは「Waiting for Love」を彷彿とさせ、16分音符フル活用により1小節内でも十分に印象的なメロディを実現しています。この瞬間、聴き手は美しさと躍動感の完璧な融合を体験します。",
        
        12: "🎼 コードハーモニーの完成：C4-F4-G4-C5のコード進行により、楽曲は単なるメロディトラックから豊かなハーモニーを持つ完成作品に進化します。このI-IV-V-I進行はAviciiが「Levels」で使用した進行と同じで、最も自然で感動的な和声の流れを作り出します。メロディとハーモニーの完璧な調和により、楽曲は真のAviciiスタイルを達成しました。",
        
        13: "🌊 完璧なドロップ体験：プラックシンセの連続パターンにより、楽曲は「Levels」そのもののエネルギーを獲得しました。G4の16分音符リピートは、Avicii特有の「シンプルだが中毒性のある」サウンドを完璧に再現しています。すべての要素が統合され、美しいピアノから始まった楽曲が世界中のフェスティバルで愛される感動的なEDMに変化しました。",
        
        14: "🌅 感情的移行の準備：ストリングスのスイープ効果により、楽曲は次の感情的なセクションへの移行を準備します。Aviciiの楽曲では、エネルギッシュなドロップの後に必ず感情的で美しいブレイクダウンが配置され、聴き手に多層的な音楽体験を提供します。この移行技術こそが、Aviciiを単なるEDMプロデューサーから音楽アーティストへと昇華させた要素です。",
        
        15: "🌙 美しいブレイクダウンの始まり：ドラムレスの環境でピアノとストリングスが織りなす美しいハーモニー。D4-F4-A4-D5のアルペジオは新たな調性を導入し、楽曲に感情的な深みを加えます。「Wake Me Up」のアコースティックセクションのように、EDMの中に純粋な音楽的美しさを見出すAvicii特有の手法です。この静寂の美しさが、前のドロップのエネルギーをより印象的にします。",
        
        16: "🎭 ハーモニーの深化：F3とA3のストリングスハーモニーが、ピアノメロディに深い感情的な色彩を加えます。この組み合わせはマイナーコードの暖かさと憂いを表現し、Aviciiが「For a Better Day」や「The Nights」で使用した感情表現技法です。音楽は単なる音の組み合わせを超え、人の心に直接語りかける言語となります。",
        
        17: "📉 要素の段階的削減：楽曲は終結に向けて要素をシンプル化し始めます。C4-G4のシンプルなピアノパターンは、複雑だった楽曲を純粋なエッセンスに還元していきます。Aviciiの楽曲では、どんなに複雑な展開があっても、最終的には美しいメロディという核心に収束します。これは「音楽の本質は美しさにある」というAviciiの哲学の表れです。",
        
        18: "🎯 ピアノソロの美学：すべての装飾を取り除いたピアノソロが、楽曲の純粋な美しさを表現します。C4-G4のシンプルなインターバルは、複雑だった楽曲を最も基本的で美しい音楽要素に還元します。Aviciiの「Silhouettes」のピアノパートのように、シンプルさの中にこそ真の美しさが宿ることを示しています。",
        
        19: "👋 フェードアウトの準備：同じピアノパターンの継続により、楽曲は自然なフェードアウトへの準備を整えます。音楽的な「余韻」を残すこの手法は、聴き手の心に楽曲を深く刻み込みます。Aviciiの楽曲が世界中で愛され続ける理由の一つは、この「終わった後も心に残る」美しい終結にあります。",
        
        20: "🎊 Avicii風楽曲の完成：美しいピアノアルペジオから始まり、感動的なドロップを経て、静寂な美しさで終わる完璧なAvicii風楽曲が完成しました！ピアノ、ストリングス、プラックシンセ、そしてパーカッションが織りなすサウンドは、まさに「Levels」「Wake Me Up」「Waiting for Love」といったAviciiの名曲と同じ DNA を持っています。あなたは今、世界中で愛される音楽の作り方をマスターしました！"
    },
    
    successMessages: {
        1: "🎹 美しいピアノイントロ完成！ Avicii風の感動的な音楽的旅路がスタートしました。",
        2: "🎻 ストリングスハーモニー追加！ ピアノに深みと感情的な広がりが生まれました。", 
        3: "🥁 リズム導入完了！ アコースティックからエレクトロニックへの変化が始まりました。",
        4: "🎸 ベースライン完成！ I-IV-V-I進行で楽曲に安定感と推進力が生まれました。",
        5: "✨ プラックシンセ追加！ Avicii特有のシンコペーションで躍動感が生まれました。",
        6: "🎯 リズムセクション完成！ EDMグルーヴが確立され、踊れる楽曲になりました。",
        7: "⚡ 感動的メロディ完成！ Avicii風の印象的なメロディラインが誕生しました。",
        8: "👏 エネルギー最大到達！ すべての要素が調和したAviciiサウンドが完成しました。",
        9: "🚀 ビルドアップ開始！ 次の展開への期待感が高まり始めました。",
        10: "📈 テンション構築完成！ ドロップへの強烈な期待感が最高潮に達しました。",
        11: "💥 感動的ドロップ爆発！ 美しいピアノから始まった楽曲が壮大なクライマックスに到達しました。",
        12: "🎼 ハーモニー完成！ コード進行により楽曲が完成された音楽作品に進化しました。",
        13: "🌊 完璧なAviciiドロップ完成！ 「Levels」のような中毒性のあるサウンドが誕生しました。",
        14: "🌅 感情的移行準備完了！ 次のセクションへの美しい橋渡しが完成しました。",
        15: "🌙 美しいブレイクダウン完成！ ピアノとストリングスが織りなす感動的なハーモニーが誕生しました。",
        16: "🎭 ハーモニー深化完了！ 感情的な深みと色彩が楽曲に加わりました。",
        17: "📉 要素削減完了！ 楽曲が純粋なエッセンスに収束し始めました。",
        18: "🎯 ピアノソロ完成！ シンプルな美しさで楽曲の核心を表現しました。",
        19: "👋 フェードアウト準備完了！ 心に残る美しい余韻が生まれました。",
        20: "🎊 Avicii風楽曲完成！ 世界中で愛される音楽の作り方をマスターしました！"
    },
    
    createInitialData() {
        const emptyPattern = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
        const allTracks = ['kick', 'snare', 'hihat', 'clap', 'bass', 'melody', 'chord', 'piano', 'pluck', 'strings', 'uplifter', 'riser', 'sweep'];
        const sections = Object.keys(this.sections);
        const preSection = ['preBuildup', 'preDrop', 'preBreakdown', 'preOutro'];
        
        const initialData = { sections: {} };
        
        sections.forEach(sectionKey => {
            initialData.sections[sectionKey] = {
                patterns: {},
                matrix: {}
            };
            
            allTracks.forEach(track => {
                initialData.sections[sectionKey].patterns[track] = [...emptyPattern];
                
                if (preSection.includes(sectionKey)) {
                    initialData.sections[sectionKey].matrix[track] = { repeat1: false };
                } else {
                    initialData.sections[sectionKey].matrix[track] = { repeat1: false, repeat2: false };
                }
            });
        });
        
        return initialData;
    }
};